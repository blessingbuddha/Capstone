<?xml version="1.0" encoding="UTF-8"?><sqlb_project><db path="C:/Users/fredv/coding/SavvyCoders/Capstone/SQL/Schools SQL.2.db" readonly="0" foreign_keys="1" case_sensitive_like="0" temp_store="0" wal_autocheckpoint="1000" synchronous="2"/><attached/><window><main_tabs open="structure browser pragmas query" current="3"/></window><tab_structure><column_width id="0" width="300"/><column_width id="1" width="0"/><column_width id="2" width="100"/><column_width id="3" width="16307"/><column_width id="4" width="0"/><expanded_item id="0" parent="1"/><expanded_item id="1" parent="1"/><expanded_item id="2" parent="1"/><expanded_item id="3" parent="1"/></tab_structure><tab_browse><current_table name="4,4:mainMLS2"/><default_encoding codec=""/><browse_table_settings><table schema="main" name="Crime Rate Capstone" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_"><sort/><column_widths><column index="1" value="70"/><column index="2" value="150"/><column index="3" value="150"/><column index="4" value="242"/><column index="5" value="105"/><column index="6" value="231"/><column index="7" value="82"/><column index="8" value="156"/><column index="9" value="94"/><column index="10" value="69"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="MLS2" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_"><sort/><column_widths><column index="1" value="92"/><column index="2" value="106"/><column index="3" value="60"/><column index="4" value="108"/><column index="5" value="114"/><column index="6" value="141"/><column index="7" value="95"/><column index="8" value="113"/><column index="9" value="91"/><column index="10" value="105"/><column index="11" value="67"/><column index="12" value="63"/><column index="13" value="72"/><column index="14" value="83"/><column index="15" value="103"/><column index="16" value="49"/><column index="17" value="265"/><column index="18" value="185"/><column index="19" value="199"/><column index="20" value="139"/><column index="21" value="300"/><column index="22" value="300"/><column index="23" value="300"/><column index="24" value="94"/><column index="26" value="104"/><column index="27" value="64"/><column index="28" value="74"/><column index="29" value="103"/><column index="30" value="114"/><column index="31" value="76"/><column index="32" value="81"/><column index="33" value="74"/><column index="34" value="79"/><column index="35" value="86"/><column index="36" value="91"/><column index="37" value="130"/><column index="38" value="63"/><column index="39" value="127"/><column index="40" value="182"/><column index="41" value="91"/><column index="42" value="117"/><column index="43" value="277"/><column index="44" value="46"/><column index="45" value="54"/><column index="46" value="117"/><column index="47" value="300"/><column index="48" value="120"/><column index="49" value="168"/><column index="50" value="135"/><column index="51" value="300"/><column index="52" value="138"/><column index="53" value="161"/><column index="54" value="138"/><column index="55" value="162"/><column index="56" value="103"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="Schools_2022_to_2023" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_"><sort/><column_widths><column index="1" value="73"/><column index="2" value="60"/><column index="3" value="54"/><column index="4" value="95"/><column index="5" value="300"/><column index="6" value="300"/><column index="7" value="191"/><column index="8" value="105"/><column index="9" value="48"/><column index="10" value="86"/><column index="11" value="300"/><column index="12" value="57"/><column index="13" value="41"/><column index="14" value="49"/><column index="15" value="70"/><column index="16" value="70"/><column index="17" value="101"/><column index="18" value="85"/><column index="19" value="84"/><column index="20" value="44"/><column index="21" value="71"/><column index="22" value="84"/><column index="23" value="133"/><column index="24" value="62"/><column index="25" value="49"/><column index="26" value="75"/><column index="27" value="79"/><column index="28" value="82"/><column index="29" value="86"/><column index="30" value="73"/><column index="31" value="77"/><column index="32" value="73"/><column index="33" value="191"/><column index="34" value="50"/><column index="35" value="60"/><column index="36" value="186"/><column index="37" value="64"/><column index="38" value="127"/><column index="39" value="181"/><column index="40" value="112"/><column index="41" value="61"/><column index="42" value="93"/><column index="43" value="75"/><column index="44" value="96"/><column index="45" value="57"/><column index="46" value="77"/><column index="47" value="69"/><column index="48" value="80"/><column index="49" value="116"/><column index="50" value="121"/><column index="51" value="116"/><column index="52" value="121"/><column index="53" value="116"/><column index="54" value="121"/><column index="55" value="121"/><column index="56" value="116"/><column index="57" value="116"/><column index="58" value="184"/><column index="59" value="232"/><column index="62" value="127"/><column index="63" value="145"/><column index="64" value="134"/><column index="65" value="82"/><column index="66" value="78"/><column index="67" value="98"/><column index="68" value="122"/><column index="69" value="160"/><column index="70" value="146"/><column index="71" value="186"/><column index="72" value="179"/><column index="73" value="212"/><column index="74" value="161"/><column index="75" value="300"/><column index="76" value="143"/><column index="77" value="165"/><column index="78" value="216"/><column index="79" value="158"/><column index="80" value="148"/><column index="81" value="130"/><column index="82" value="235"/><column index="83" value="170"/><column index="84" value="181"/><column index="85" value="163"/><column index="86" value="152"/><column index="87" value="133"/><column index="88" value="243"/><column index="89" value="243"/><column index="90" value="213"/><column index="91" value="232"/><column index="92" value="156"/><column index="93" value="300"/><column index="94" value="186"/><column index="95" value="178"/><column index="96" value="84"/><column index="97" value="157"/><column index="98" value="180"/><column index="99" value="160"/><column index="100" value="232"/><column index="101" value="158"/><column index="102" value="143"/><column index="103" value="125"/><column index="104" value="244"/><column index="105" value="165"/><column index="106" value="176"/><column index="107" value="158"/><column index="108" value="150"/><column index="109" value="128"/><column index="110" value="276"/><column index="111" value="300"/><column index="112" value="300"/><column index="113" value="144"/><column index="114" value="243"/><column index="115" value="150"/><column index="116" value="189"/><column index="117" value="142"/></column_widths><filter_values><column index="45" value="75110"/></filter_values><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="statewideoverallaccountabilityratings2022" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_"><sort/><column_widths><column index="1" value="52"/><column index="2" value="113"/><column index="3" value="74"/><column index="4" value="300"/><column index="5" value="116"/><column index="6" value="245"/><column index="7" value="178"/><column index="8" value="109"/><column index="9" value="90"/><column index="10" value="108"/><column index="11" value="247"/><column index="12" value="67"/><column index="13" value="138"/><column index="14" value="209"/><column index="15" value="127"/><column index="16" value="181"/><column index="17" value="99"/><column index="18" value="196"/><column index="19" value="191"/><column index="20" value="164"/><column index="21" value="154"/><column index="22" value="168"/><column index="23" value="163"/><column index="24" value="195"/><column index="25" value="190"/><column index="26" value="164"/><column index="27" value="152"/><column index="28" value="149"/><column index="29" value="153"/><column index="30" value="169"/><column index="31" value="168"/><column index="32" value="134"/><column index="33" value="156"/><column index="34" value="143"/><column index="35" value="183"/><column index="36" value="248"/><column index="37" value="140"/><column index="38" value="190"/><column index="39" value="120"/><column index="40" value="170"/><column index="41" value="126"/><column index="42" value="176"/><column index="43" value="243"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table></browse_table_settings></tab_browse><tab_sql><sql name="Trial">SELECT 
-- 	r.DistrictNumber, 
	s.USER_District_Number,
-- 	r.County,
	s.USER_County_Name,
	s.Postal
-- 	r.OverallRating,
-- 	field1
-- 	count(distinct r.DistrictNumber)
FROM Schools_2022_to_2023 s
LEFT join statewideoverallaccountabilityratings2022 r
on s.USER_School_Number = r.Number 
-- 	AND r.County = &quot;HARRIS&quot;
-- AND s.USER_District_Name = &quot;HARRIS COUNTY&quot;
WHERE 
	s.USER_County_Name = &quot;HARRIS COUNTY&quot;
	AND
	s.Subregion = &quot;Harris County&quot;
-- 	r.County = &quot;HARRIS&quot;
-- group by USER_District_Name
ORDER by 1</sql><sql name="Trial 2">SELECT 
	r.CampusNumber,
	r.DistrictNumber, 
	s.USER_District_Number,
	r.County,
	s.USER_County_Name,
	s.Postal,
	r.OverallRating,
-- 	field1
-- 	count(distinct r.DistrictNumber)
FROM Schools_2022_to_2023 s
INNER join statewideoverallaccountabilityratings2022 r
on s.USER_School_Number = r.CampusNumber
	AND r.County = &quot;HARRIS&quot;
-- AND s.USER_District_Name = &quot;HARRIS COUNTY&quot;
-- WHERE 
-- -- 	s.USER_District_Name = &quot;HARRIS COUNTY&quot;
-- 	r.County = &quot;HARRIS&quot;
group by USER_District_Name
ORDER by 1</sql><sql name="In-Join">SELECT 
	CampusNumber,
	Postal,
	OverallRating
FROM Schools_2022_to_2023
	INNER join statewideoverallaccountabilityratings2022
		ON USER_School_Number = CampusNumber
WHERE
	County = &quot;HARRIS&quot;
ORDER BY CampusNumber</sql><sql name="In-Join Campus Number">SELECT 
	CampusNumber,
	Postal,
	OverallRating,
    COUNT(*) AS &quot;num of school&quot;,
    OverallScore,
	OverallRating,
    ROUND(AVG(OverallScore), 2) AS &quot;avg score&quot;,
	
	   
    CASE 
        WHEN ROUND(AVG(OverallScore), 2) &gt;= 90 AND ROUND(AVG(OverallScore), 2) &lt; 100 THEN 'A'
        WHEN ROUND(AVG(OverallScore), 2) &gt;= 80 AND ROUND(AVG(OverallScore), 2) &lt; 89 THEN 'B'
        WHEN ROUND(AVG(OverallScore), 2) &gt;= 70 AND ROUND(AVG(OverallScore), 2) &lt; 79 THEN 'C'
        WHEN ROUND(AVG(OverallScore), 2) &gt;= 60 AND ROUND(AVG(OverallScore), 2) &lt; 69 THEN 'D'
        ELSE 'F'
    END AS AvgOverallRating
	
FROM Schools_2022_to_2023 
	INNER join statewideoverallaccountabilityratings2022 
		ON USER_School_Number = CampusNumber
WHERE
	County = &quot;HARRIS&quot;
GROUP by CampusNumber
ORDER BY CampusNumber</sql><sql name="School Rating + Zip">SELECT 
	Postal,
    COUNT(*) AS &quot;num of school&quot;,
	OverallScore,
	OverallRating,
    ROUND(AVG(OverallScore), 2) AS &quot;avg score&quot;,
    CASE 
        WHEN ROUND(AVG(OverallScore), 2) &gt;= 90 AND ROUND(AVG(OverallScore), 2) &lt; 100 THEN 'A'
        WHEN ROUND(AVG(OverallScore), 2) &gt;= 80 AND ROUND(AVG(OverallScore), 2) &lt; 89 THEN 'B'
        WHEN ROUND(AVG(OverallScore), 2) &gt;= 70 AND ROUND(AVG(OverallScore), 2) &lt; 79 THEN 'C'
        WHEN ROUND(AVG(OverallScore), 2) &gt;= 60 AND ROUND(AVG(OverallScore), 2) &lt; 69 THEN 'D'
        ELSE 'F'
    END AS AvgOverallRating
	
FROM Schools_2022_to_2023 
	INNER JOIN statewideoverallaccountabilityratings2022 
	ON USER_School_Number = CampusNumber
WHERE County = 'HARRIS'
GROUP BY Postal
ORDER BY Postal;</sql><sql name="adding in MLS">SELECT 
    s.Postal,
    COUNT(*) AS &quot;num of school&quot;,
    r.OverallScore,
    ROUND(AVG(r.OverallScore), 2) AS &quot;avg score&quot;,
    CASE 
        WHEN ROUND(AVG(r.OverallScore), 2) &gt;= 90 AND ROUND(AVG(r.OverallScore), 2) &lt; 100 THEN 'A'
        WHEN ROUND(AVG(r.OverallScore), 2) &gt;= 80 AND ROUND(AVG(r.OverallScore), 2) &lt; 89 THEN 'B'
        WHEN ROUND(AVG(r.OverallScore), 2) &gt;= 70 AND ROUND(AVG(r.OverallScore), 2) &lt; 79 THEN 'C'
        WHEN ROUND(AVG(r.OverallScore), 2) &gt;= 60 AND ROUND(AVG(r.OverallScore), 2) &lt; 69 THEN 'D'
        ELSE 'F'
    END AS AvgOverallRating
	
FROM Schools_2022_to_2023 s
    INNER JOIN statewideoverallaccountabilityratings2022 r 
    ON s.USER_School_Number = r.CampusNumber
    INNER JOIN MLS2 m 
    ON s.Postal = m.ZipCode
WHERE r.County = 'HARRIS'
GROUP BY s.Postal
ORDER BY s.Postal;
</sql><sql name="Total Crime">SELECT ZIPCode, SUM(OffenseCount) AS TotalOffenseCount
FROM &quot;Crime Rate Capstone&quot;
GROUP BY ZIPCode;</sql><sql name="MLS2">SELECT
    ZipCode,
    Count(MLSNumber) AS TotalHomesSold,
    ROUND(AVG(CAST(REPLACE(SUBSTRING(ListPrice, 2), ',', '') AS DECIMAL(10, 2))), 2) AS AverageListPrice
FROM
    MLS2
GROUP BY
    ZipCode;
</sql><sql name="Rating and Crime">SELECT 
    s.Postal,
    COUNT(*) AS &quot;num of school&quot;,
    r.OverallScore,
    ROUND(AVG(r.OverallScore), 2) AS &quot;avg score&quot;,
    crime.TotalOffenseCount,
    CASE 
        WHEN ROUND(AVG(r.OverallScore), 2) &gt;= 90 AND ROUND(AVG(r.OverallScore), 2) &lt; 100 THEN 'A'
        WHEN ROUND(AVG(r.OverallScore), 2) &gt;= 80 AND ROUND(AVG(r.OverallScore), 2) &lt; 89 THEN 'B'
        WHEN ROUND(AVG(r.OverallScore), 2) &gt;= 70 AND ROUND(AVG(r.OverallScore), 2) &lt; 79 THEN 'C'
        WHEN ROUND(AVG(r.OverallScore), 2) &gt;= 60 AND ROUND(AVG(r.OverallScore), 2) &lt; 69 THEN 'D'
        ELSE 'F'
    END AS AvgOverallRating
	
FROM Schools_2022_to_2023 s
    INNER JOIN statewideoverallaccountabilityratings2022 r 
    ON s.USER_School_Number = r.CampusNumber
    INNER JOIN MLS2 m 
    ON s.Postal = m.ZipCode
    LEFT JOIN (
        SELECT ZIPCode, SUM(OffenseCount) AS TotalOffenseCount
        FROM &quot;Crime Rate Capstone&quot;
        GROUP BY ZIPCode
    ) crime ON m.ZipCode = crime.ZIPCode
    
WHERE r.County = 'HARRIS'
GROUP BY s.Postal, crime.TotalOffenseCount
ORDER BY s.Postal;
</sql><sql name="SQL 11">SELECT 
    s.Postal,
    COUNT(*) AS &quot;num of school&quot;,
    r.OverallScore,
    ROUND(AVG(r.OverallScore), 2) AS &quot;avg score&quot;,
    crime.TotalOffenseCount,
    mls.TotalHomesSold,
    mls.AverageListPrice,
    CASE 
        WHEN ROUND(AVG(r.OverallScore), 2) &gt;= 90 AND ROUND(AVG(r.OverallScore), 2) &lt; 100 THEN 'A'
        WHEN ROUND(AVG(r.OverallScore), 2) &gt;= 80 AND ROUND(AVG(r.OverallScore), 2) &lt; 89 THEN 'B'
        WHEN ROUND(AVG(r.OverallScore), 2) &gt;= 70 AND ROUND(AVG(r.OverallScore), 2) &lt; 79 THEN 'C'
        WHEN ROUND(AVG(r.OverallScore), 2) &gt;= 60 AND ROUND(AVG(r.OverallScore), 2) &lt; 69 THEN 'D'
        ELSE 'F'
    END AS AvgOverallRating
	
FROM Schools_2022_to_2023 s
    INNER JOIN statewideoverallaccountabilityratings2022 r 
    ON s.USER_School_Number = r.CampusNumber
    INNER JOIN MLS2 m 
    ON s.Postal = m.ZipCode
    LEFT JOIN (
        SELECT ZIPCode, SUM(OffenseCount) AS TotalOffenseCount
        FROM &quot;Crime Rate Capstone&quot;
        GROUP BY ZIPCode
    ) crime ON m.ZipCode = crime.ZIPCode
    LEFT JOIN (
        SELECT
            ZipCode,
            COUNT(MLSNumber) AS TotalHomesSold,
            ROUND(AVG(CAST(REPLACE(SUBSTRING(ListPrice, 2), ',', '') AS DECIMAL(10, 2))), 2) AS AverageListPrice
        FROM MLS2
        GROUP BY ZipCode
    ) mls ON m.ZipCode = mls.ZipCode
    
WHERE r.County = 'HARRIS'
GROUP BY s.Postal, crime.TotalOffenseCount, mls.TotalHomesSold, mls.AverageListPrice
ORDER BY s.Postal;</sql><sql name="SQL 12">SELECT 
    m.ZipCode,
    COUNT(*) AS &quot;num of school&quot;,
    r.OverallScore,
    ROUND(AVG(r.OverallScore), 2) AS &quot;avg score&quot;,
    crime.TotalOffenseCount,
    mls.TotalHomesSold,
    mls.AverageListPrice,
    CASE 
        WHEN ROUND(AVG(r.OverallScore), 2) &gt;= 90 AND ROUND(AVG(r.OverallScore), 2) &lt; 100 THEN 'A'
        WHEN ROUND(AVG(r.OverallScore), 2) &gt;= 80 AND ROUND(AVG(r.OverallScore), 2) &lt; 89 THEN 'B'
        WHEN ROUND(AVG(r.OverallScore), 2) &gt;= 70 AND ROUND(AVG(r.OverallScore), 2) &lt; 79 THEN 'C'
        WHEN ROUND(AVG(r.OverallScore), 2) &gt;= 60 AND ROUND(AVG(r.OverallScore), 2) &lt; 69 THEN 'D'
        ELSE 'F'
    END AS AvgOverallRating
	
FROM MLS2 m
    LEFT JOIN Schools_2022_to_2023 s
    ON m.ZipCode = s.Postal
    LEFT JOIN statewideoverallaccountabilityratings2022 r 
    ON s.USER_School_Number = r.CampusNumber
    LEFT JOIN (
        SELECT ZIPCode, SUM(OffenseCount) AS TotalOffenseCount
        FROM &quot;Crime Rate Capstone&quot;
        GROUP BY ZIPCode
    ) crime ON m.ZipCode = crime.ZIPCode
    LEFT JOIN (
        SELECT
            ZipCode,
            COUNT(MLSNumber) AS TotalHomesSold,
            ROUND(AVG(CAST(REPLACE(SUBSTRING(ListPrice, 2), ',', '') AS DECIMAL(10, 2))), 2) AS AverageListPrice
        FROM MLS2
        GROUP BY ZipCode
    ) mls ON m.ZipCode = mls.ZipCode
    
GROUP BY m.ZipCode
-- , r.OverallScore, crime.TotalOffenseCount, mls.TotalHomesSold, mls.AverageListPrice
ORDER BY m.ZipCode;</sql><sql name="Completed">SELECT 
    m.ZipCode,
    crime.TotalOffenseCount,
    mls.TotalHomesSold,
    mls.AverageListPrice,
    COUNT(*) AS &quot;num of school&quot;,
	ROUND(AVG(r.OverallScore), 2) AS &quot;avg score&quot;,
    CASE 
        WHEN ROUND(AVG(r.OverallScore), 2) &gt;= 90 AND ROUND(AVG(r.OverallScore), 2) &lt; 100 THEN 'A'
        WHEN ROUND(AVG(r.OverallScore), 2) &gt;= 80 AND ROUND(AVG(r.OverallScore), 2) &lt; 89 THEN 'B'
        WHEN ROUND(AVG(r.OverallScore), 2) &gt;= 70 AND ROUND(AVG(r.OverallScore), 2) &lt; 79 THEN 'C'
        WHEN ROUND(AVG(r.OverallScore), 2) &gt;= 60 AND ROUND(AVG(r.OverallScore), 2) &lt; 69 THEN 'D'
        ELSE 'F'
    END AS AvgOverallRating
	
FROM MLS2 m
    LEFT JOIN Schools_2022_to_2023 s
    ON m.ZipCode = s.Postal
    LEFT JOIN statewideoverallaccountabilityratings2022 r 
    ON s.USER_School_Number = r.CampusNumber
    LEFT JOIN (
        SELECT ZIPCode, SUM(OffenseCount) AS TotalOffenseCount
        FROM &quot;Crime Rate Capstone&quot;
        GROUP BY ZIPCode
    ) crime ON m.ZipCode = crime.ZIPCode
    LEFT JOIN (
        SELECT
            ZipCode,
            COUNT(MLSNumber) AS TotalHomesSold,
            ROUND(AVG(CAST(REPLACE(SUBSTRING(ListPrice, 2), ',', '') AS DECIMAL(10, 2))), 2) AS AverageListPrice
        FROM MLS2
        GROUP BY ZipCode
    ) mls ON m.ZipCode = mls.ZipCode
    
GROUP BY m.ZipCode
ORDER BY m.ZipCode;</sql><current_tab id="11"/></tab_sql></sqlb_project>
